cat > index.html <<'EOF'
---
layout: default
---

<div class="hero-section">
  <div class="hero-content">
    <div class="animated-logo">
      <img src="{{ site.institution.logo | relative_url }}" alt="Logo" class="logo-img pulse">
    </div>
    <h1 class="animated-title">{{ site.title }}</h1>
    <div class="quote-container">
      <blockquote id="daily-quote" class="daily-quote fade-in">
        {{ site.data.frases[0].texto }}
      </blockquote>
      <cite id="quote-author">{{ site.data.frases[0].autor }}</cite>
    </div>
  </div>
  <div class="scroll-indicator">
    <div class="mouse"></div>
  </div>
</div>

<section class="featured-news">
  <div class="container">
    <h2 class="section-title">
      <span class="icon">ðŸ“°</span>
      Noticias Destacadas
    </h2>
    
    <div class="news-grid">
      {% assign destacados = site.noticias | where: "destacado", true | sort: "date" | reverse %}
{% for noticia in destacados limit:6 %}
<article class="news-card" data-aos="fade-up" data-aos-delay="{{ forloop.index | times: 100 }}">
  {% if noticia.image %}
  <div class="news-image">
    <img src="{{ noticia.image | relative_url }}" alt="{{ noticia.title }}">
    <div class="news-overlay">
      <span class="news-category">{{ noticia.category }}</span>
    </div>
  </div>
  {% endif %}
  
  <div class="news-content">
    <h3 class="news-title">
      <a href="{{ noticia.url | relative_url }}">{{ noticia.title }}</a>
    </h3>
    <p class="news-excerpt">{{ noticia.excerpt | strip_html | truncate: 150 }}</p>
    <div class="news-meta">
      <span class="news-date">
        <i class="icon-calendar">ðŸ“…</i>
        {{ noticia.date | date: "%d/%m/%Y" }}
      </span>

      <!-- BOTÃ“N que abre el modal (no navega) -->
      <button class="read-more-btn" data-index="{{ forloop.index0 }}" aria-haspopup="dialog" aria-controls="news-modal">
        Leer mÃ¡s <span class="arrow">â†’</span>
      </button>
    </div>
  </div>
</article>

<!-- CONTENIDO COMPLETO OCULTO (pre-renderizado) -->
<div class="noticia-full-data" id="noticia-full-{{ forloop.index0 }}" style="display:none;">
  <h2 class="hidden-title">{{ noticia.title }}</h2>
  <div class="hidden-meta">
    <span class="hidden-date">{{ noticia.date | date: "%d de %B de %Y" }}</span>
    {% if noticia.author %}<span class="hidden-author"> â€” {{ noticia.author }}</span>{% endif %}
  </div>
  {% if noticia.image %}
  <div class="hidden-image">
    <img src="{{ noticia.image | relative_url }}" alt="{{ noticia.title }}">
  </div>
  {% endif %}
  <div class="hidden-content">
    {{ noticia.content | markdownify }}
  </div>
</div>
{% endfor %}
    </div>
  </div>
</section>

<!-- Multimedia, eventos y audio (usar relative_url para rutas) -->
<section class="multimedia-section">
  <div class="container">
    <h2 class="section-title">
      <span class="icon">ðŸŽ¥</span>
      Multimedia
    </h2>
    <div class="multimedia-grid">
      <div class="multimedia-card video-card" data-aos="zoom-in">
        <h3>Videos Recientes</h3>
        <div class="video-container">
          {% if site.data.videos and site.data.videos.size > 0 %}
            <iframe src="{{ site.data.videos[0].url }}" frameborder="0" allowfullscreen></iframe>
          {% else %}
            <div style="padding: 40px; text-align: center; color: #666;">
              <p>ðŸ“¹ PrÃ³ximamente agregaremos videos</p>
            </div>
          {% endif %}
        </div>
      </div>
      <div class="multimedia-card gallery-preview" data-aos="zoom-in" data-aos-delay="200">
        <h3>GalerÃ­a de Fotos</h3>
        <div class="photo-grid">
          {% if site.data.fotos %}
            {% for foto in site.data.fotos limit:4 %}
            <div class="photo-item">
              <img src="{{ foto.url | relative_url }}" alt="{{ foto.title }}">
            </div>
            {% endfor %}
          {% else %}
            <div style="grid-column: 1 / -1; padding: 40px; text-align: center; color: #666;">
              <p>ðŸ“¸ PrÃ³ximamente agregaremos fotos</p>
            </div>
          {% endif %}
        </div>
        <a href="{{ '/galeria/' | relative_url }}" class="btn-secondary">Ver todas las fotos</a>
      </div>
    </div>
  </div>
</section>

<section class="events-section">
  <div class="container">
    <h2 class="section-title">
      <span class="icon">ðŸ“…</span>
      PrÃ³ximos Eventos
    </h2>
    <div class="events-timeline">
      {% for evento in site.eventos limit:4 %}
      <div class="event-item" data-aos="fade-right">
        <div class="event-date">
          <span class="day">{{ evento.date | date: "%d" }}</span>
          <span class="month">{{ evento.date | date: "%b" }}</span>
        </div>
        <div class="event-content">
          <h3>{{ evento.title }}</h3>
          <p>{{ evento.description }}</p>
          <a href="{{ evento.url | relative_url }}" class="event-link">Ver detalles â†’</a>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</section>

<!-- Control de audio del himno -->
<div id="audio-player" class="audio-player">
  <audio id="himno" loop>
    <source src="{{ site.institution.anthem | relative_url }}" type="audio/mpeg">
  </audio>
  <button id="toggle-audio" class="audio-toggle" aria-label="Reproducir/Pausar Himno">
    <span class="play-icon">ðŸ”Š</span>
    <span class="pause-icon" style="display:none;">ðŸ”‡</span>
  </button>
</div>


<div id="news-modal" class="modal" role="dialog" aria-modal="true" aria-hidden="true" style="display:none;">
  <div class="modal-backdrop" data-close="true"></div>
  <div class="modal-body" role="document" tabindex="-1">
    <button class="modal-close" aria-label="Cerrar">âœ•</button>
    <article class="modal-article">
      <header>
        <h1 id="modal-title"></h1>
        <p id="modal-meta" class="modal-meta"></p>
        <div id="modal-image" class="modal-image"></div>
      </header>
      <section id="modal-content" class="modal-content"></section>
    </article>
  </div>
</div>

<style>
/* Estilos bÃ¡sicos del modal â€” ajusta segÃºn tu tema */
.modal { position: fixed; inset: 0; z-index: 9999; display: flex; align-items: center; justify-content: center; }
.modal-backdrop { position:absolute; inset:0; background: rgba(0,0,0,0.6); }
.modal-body { position: relative; max-width: 900px; width: 95%; max-height: 90vh; overflow:auto; background: #fff; border-radius: 12px; padding: 24px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); z-index: 2; }
.modal-close { position: absolute; right: 12px; top: 12px; border: none; background: transparent; font-size: 20px; cursor: pointer; }
.modal-image img { width:100%; border-radius: 10px; margin: 12px 0; object-fit: cover; max-height: 320px; }
.modal-meta { color:#666; font-size:0.95rem; margin-bottom:8px; }
.modal-content { color:#333; line-height:1.8; font-size:1rem; }
@media (max-width: 640px) { .modal-body { padding: 16px; } .modal-image img { max-height:200px } }
</style>

<script>
(function(){
  const modal = document.getElementById('news-modal');
  const modalTitle = document.getElementById('modal-title');
  const modalMeta = document.getElementById('modal-meta');
  const modalImage = document.getElementById('modal-image');
  const modalContent = document.getElementById('modal-content');
  const closeBtn = modal.querySelector('.modal-close');
  const backdrop = modal.querySelector('.modal-backdrop');

  function openModal(index) {
    const data = document.getElementById('noticia-full-' + index);
    if(!data) return;
    // POBLAR modal
    modalTitle.innerHTML = data.querySelector('.hidden-title')?.innerHTML || '';
    modalMeta.innerHTML = data.querySelector('.hidden-meta')?.innerHTML || '';
    const imgNode = data.querySelector('.hidden-image');
    modalImage.innerHTML = imgNode ? imgNode.innerHTML : '';
    modalContent.innerHTML = data.querySelector('.hidden-content')?.innerHTML || '';
    // Mostrar modal
    modal.style.display = 'flex';
    modal.setAttribute('aria-hidden', 'false');
    // focus trap (simple)
    modal.querySelector('.modal-body').focus();
    document.body.style.overflow = 'hidden';
  }

  function closeModal() {
    modal.style.display = 'none';
    modal.setAttribute('aria-hidden', 'true');
    modalTitle.innerHTML = '';
    modalMeta.innerHTML = '';
    modalImage.innerHTML = '';
    modalContent.innerHTML = '';
    document.body.style.overflow = '';
  }

  // DelegaciÃ³n: botones "Leer mÃ¡s"
  document.addEventListener('click', function(e){
    const btn = e.target.closest('.read-more-btn');
    if(btn){
      e.preventDefault();
      const idx = btn.getAttribute('data-index');
      openModal(idx);
    }
    if(e.target.closest('[data-close="true"]') || e.target.closest('.modal-close')) {
      closeModal();
    }
  });

  // cerrar con ESC
  document.addEventListener('keydown', function(e){
    if(e.key === 'Escape' && modal.style.display === 'flex') closeModal();
  });

  // cerrar si se hace click fuera del modal-body (backdrop)
  backdrop.addEventListener('click', closeModal);
})();
</script>
EOF
